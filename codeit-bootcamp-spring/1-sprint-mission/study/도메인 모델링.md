# Domain Modeling
디스코드 서비스를 활용하면서 각 도메인 모델에 필요한 정보를 도출한다.


- User
- Channel
- Message

## 유저

- 회원 가입
  - `이메일`, `별명`, `사용자명`, `비밀번호`, `생년월일`, `수신여부` 를 입력받는다.
    - 별명 : 다른 회원에게 보여지는 이름입니다. 이모지 사용가능합니다.
      - 서버마다 다르게 설정가능
      - 최소 1~ 최대 32자
    - 사용자명: 숫자,밑줄 _, 마침표, 문자
      - 길이제한: 최소 2 ~ 최대 32자
      - 사용가능문자 : 영문(a-z, A-z), 숫자(0-9), 밑줄(_), 마침표(.)
      - 금지된 문자: 공백, 특수문자, 이모지, 연속된마침표, 마침표로 시작하거나 끝나는것
      - 대소문자 구분없음 -> 중복 방지를 위해 모두 소문자로 변환하여 저장함
      - 유저이름은 고유
      - 특정 문자 단어제한 : discord, admin, moderator, 욕설
    - 비밀번호: 필수, 개수 제한 8미만 x , 영문 대문자, 소문자, 숫자, 특수문자가 들어가야합니다. 공백 x
    - 생년월일: 필수, 13세 이상만 사용가능
  - 사용하고 있는 이메일인지 검증한다.
  - 사용하고 있는 유저이름인지 검증한다.
  - 비밀번호를 저장할 때 암호화를 진행한다.
    - [jBCrypt](https://www.mindrot.org/projects/jBCrypt/)
  - 회원 프로필 사진을 저장한다.
    - 파일을 입력받아 저장한다.

- 로그인
  - `이메일`과 `비밀번호`를 입력받는다.
    - 유저의 비밀번호가 틀리다면 에러를 반환한다.

- 비밀번호 변경
  - flow
    - 본인이 맞는지 기존 비밀번호를 확인한다.
    - 변경 비밀번호를 입력받는다.
    - 디비에서 유저조회
    - 조횐된 유저의 비밀번호를 암호화 후 변경
    - 디비에 저장
  - 리팩터링할 부분 : 토큰으로 일회용 토큰으로 기존 비밀번호 확인 후 토큰이 없다면 불가하게 하는방법 구현하기
- 수신 여부 변경

## 채널
- 새로운 채널 생성
  - `채널이름`, `채널 유형`, `채널 생성 유저`를 입력받는다.
    - 텍스트 채널 유형
    - 음성, 영상, 화면 유형
    - 채널 주제 (생성 시에는 입력받지 않음, 1024 글자 제한)
- 채널 삭제
  - 채널 매니저가 아닐 경우 에러
- 채널 정보 수정
  - 채널 매니저가 아닐 경우 에러
    - 이름 수정
    - 채널 주제 수정 1024 글자제한

## 메세지

- 새로운 메시지 생성
  - `메시지 id`, `메시지 생성, 수정시간`, `메시지 내용`, `보낸사람`, `목적지 채널`
    - 메시지 내용은 비어있을 수 없다.
- 메시지 내용 수정
  - 발신자가 아니라면 에러
- 메시지 삭제
  - 발진자가 아니라면 에러


## ReadStatus
  - 사용자가 채널 별 마지막으로 메시지를 읽은 시간을 표현하는 도메인 모델입니다. 사용자별 각 채널에 읽지 않은 메시지를 확인하기 위해 활용합니다.
  - `id`, `createdAt`, `updatedAt`

  - 유저가 채널별 읽은 시간을 기록한다.
    - 유저가 채널에 접속한 시간을 업데이트한다.
      - 접속한 적이 없는 경우에는 새로운 객체를 생성하여 저장한다.
      - 접속한 적이 있는 경우에는 기존 객체의 접속 시간을 업데이트한다.

## UserStatus
- 사용자 별 마지막으로 확인된 접속 시간을 표현하는 도메인 모델입니다. 사용자의 온라인 상태를 확인하기 위해 활용합니다.
- 마지막 접속 시간을 기준으로 현재 로그인한 유저로 판단할 수 있는 메소드를 정의하세요.
  - 마지막 접속 시간이 현재 시간으로부터 5분 이내이면 현재 접속 중인 유저로 간주합니다.
- `id`, `createdAt`, `updatedAt`

## BinaryContent
- 이미지, 파일 등 바이너리 데이터를 표현하는 도메인 모델입니다. 사용자의 프로필 이미지, 메시지에 첨부된 파일을 저장하기 위해 활용합니다.
-  수정 불가능한 도메인 모델로 간주합니다. 따라서 updatedAt 필드는 정의하지 않습니다.
-  User, Message 도메인 모델과의 의존 관계 방향성을 잘 고려하여 id 참조 필드를 추가하세요.

-- newLine for git
