<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>User Info</title>
    <style>
        body { font-family: Arial, sans-serif; }
        .container { max-width: 600px; margin: auto; padding: 20px; }
    </style>
    <script>
        function updateUserStatus(selectElement) {
            let userId = selectElement.getAttribute("data-user-id");
            let newStatus = selectElement.value;

            fetch(`/api/v1/user/${userId}/status`, {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({ status: newStatus })
            }).then(response => {
                if (response.ok) {
                    alert("상태가 업데이트되었습니다!");
                } else {
                    alert("업데이트 실패!");
                }
            }).catch(error => console.error("Error:", error));
        }
    </script>
</head>
<body>
<div class="container">
    <h2>User Information</h2>
    <p><strong>userId:</strong> <span th:text="${user.userId}"></span></p>
    <p><strong>Username:</strong> <span th:text="${user.username}"></span></p>
    <p><strong>Email:</strong> <span th:text="${user.email}"></span></p>
    <p><strong>Nickname:</strong> <span th:text="${user.nickname}"></span></p>
    <p><strong>Phone Number:</strong> <span th:text="${user.phoneNumber}"></span></p>
    <p>
        <strong>Status:</strong>
        <select th:data-user-id="${user.userId}" onchange="updateUserStatus(this)">
            <option value="ONLINE" th:selected="${user.userStatus == 'ONLINE'}">ONLINE</option>
            <option value="IDLE" th:selected="${user.userStatus == 'IDLE'}">IDLE</option>
            <option value="OFFLINE" th:selected="${user.userStatus == 'OFFLINE'}">OFFLINE</option>
        </select>
    </p>

    <div th:if="${user.profilePictureBase64 != null}">
        <img th:src="'data:image/png;base64,' + ${user.profilePictureBase64}"
             alt="Profile Picture" width="100"/>
    </div>
    <p th:if="${user.profilePictureBase64 == null}">No Profile Picture</p>
</div>
</body>
</html>
